# NAMD-MD
For any proteins with a broken backbone, a homology modelly is highly recommended in order to obtain a "perfect" structure with all gaps properly filled.
<p align="center">
<img width="621" alt="Screen Shot 2021-11-07 at 7 57 55 PM" src="https://user-images.githubusercontent.com/75652473/140644062-76014951-35d5-4c66-8c5e-54c83b5616c5.png">
</p>

Note, the way of combining protein with ligand now is recommened to use pymol instead of mannually modification, relavent command for pymol has been included in notebook.

<p align="center">
  <img width="485" alt="Screen Shot 2021-10-23 at 8 15 26 PM" src="https://user-images.githubusercontent.com/75652473/138555675-d44e01b9-5486-4140-b2ec-64a99c460c50.png">
</p>
USAGE: The primary goal is to generate two files, called ionized.pdb and ionized.psf, then you define a NAMD configuration file sourceing these two file to carry out a simultion, wtih protein parameter files and small molecule parameter files defined, as per in the above "min.conf", CHANGE the file path if you need to.
To run a simulation, first run the "namd3 nvt.namd" then run the "namd3 npt.namd", finally run "namd3 production.namd". If you want to make it even better, you then need to define some restrain by yourself, which is out of the scope of this repository.

You could use namd configuration files listed above, or generate your own, some references are 
https://www.iitg.ac.in/tamalb/karp/namd/cf.html and https://www.ks.uiuc.edu/Training/Tutorials/namd/namd-tutorial-unix-html/node26.html 

This is for a general solution simulation for a RCSB PDB structure with a ligand, with a special foucs on small molecule ligand.
This notebook take http://zarbi.chem.yale.edu/ligpargen/namd_tutorial.html as a general refernce

You could also use this script to simulate a docked complex, but in that case, more extra work outside of this notebook are supposed to be done, mainly in manuplating the complex.pdb file in a text editing tool such as sublime text, changing the atom numbering (you might need excel in this case) and chain name etc. If you are not confident engough to do such tricy things, you are suggested to produced ionized.psf and ionized.pdb on your local vmd instead running step 4 in the notebook.

Particularly, the "complex.pdb" need modification, the inter section of protein and ligand should be separated by a TER key word. This file is generated by pymol, or by mannually modificaiton if you are patient enough.

<p align="center">
  <img width="485" alt="Screen Shot 2021-10-23 at 8 15 26 PM" src="https://user-images.githubusercontent.com/75652473/141260042-e461df74-bbba-47ae-a98f-5884b444cbb5.png">
</p>
The end of the comple.pdb file looks like:
<p align="center">
  <img width="485" alt="Screen Shot 2021-10-23 at 8 15 26 PM" src="https://user-images.githubusercontent.com/75652473/141260155-977e07db-4baa-463c-8ba6-f817b223ca30.png">
</p>

NOTE, you need to include the provided water topology/parameter files in the configration file to prevent a "vdw parameter not found for atom type OT" error.

The configuration file need modification, like the "parameters" lines, and the PBC section.
![image](https://user-images.githubusercontent.com/75652473/138555517-f6562583-030c-4fa1-944c-a8d42bbbfe3a.png)

If you want to set up a restrain before the simulation, have a look at http://www.ub.edu/cbdd/?q=content/using-namd-harmonic-restraints




